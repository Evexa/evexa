SA_QuestionsList={init:function(e){this.signedParameters=e.signedParameters,this.blockParent=document.querySelector(".reviews__content_wrapper"),this.blockParent&&(this.btnLike=this.blockParent.querySelectorAll('[data-type="like"]'),this.btnEdit=this.blockParent.querySelectorAll('[data-type="edit"]'),this.btnMore=document.querySelector(".more-reviews button"),this.btnLike&&this.initEventLike(),this.btnMore&&this.initMore(),this.btnEdit&&this.initEventEdit())},initEventLike:function(){this.btnLike.forEach((e=>{e.addEventListener("click",(t=>{this.isNeedActiveLike=!0,e.closest(".content__reviews__item__control").querySelectorAll(".content__reviews__item__control__item").forEach((t=>{t.classList.contains("btn-reviews-small--active")&&t!=e&&(this.isNeedActiveLike=!1,this.elementRecalculationLike(t,!1),this.elementRecalculationLike(e))})),this.isNeedActiveLike&&this.elementRecalculationLike(e)}))}))},initEventEdit:function(){this.btnEdit.forEach((e=>{e.addEventListener("click",(()=>{SA_QuestionsAdd.form.querySelector('[name="QUESTION"]').value=e.closest(".reviews__content").querySelector(".content__reviews__item__body p").innerHTML.trim(),SA_QuestionsAdd.form.appendChild(SA_ReviewsAdd.hiddenInputs[e.dataset.id]=BX.create("input",{attrs:{type:"hidden",name:"ID",value:e.dataset.id}})),SA_QuestionsAdd.form.querySelector('[name="QUESTION"]').focus()}))}))},initMore:function(){this.btnMore.addEventListener("click",(()=>{let e=this.btnMore.value;e<=0?(this.btnMore.setAttribute("value","2"),e=2):this.btnMore.setAttribute("value",e=Number(e)+1),this.moreQuestionsController(e)}))},editQuestionsController:async function(e){BX.ajax.runComponentAction("sotbit:rvw.questions.list","edit",{mode:"class",data:new FormData(e)}).then((()=>{SA_QuestionsAdd.showModalResult(BX.message("TITLE_MODAL_EDIT"),"success"),SA_QuestionsAdd.deleteFormField(),SA_Questions.reloadList({})}),(e=>{BX.closeWait(),SA_QuestionsAdd.showModalResult(e.errors.map((e=>e.message)).join("\n"),"error")}))},moreQuestionsController:async function(e){try{BX.showWait();const{data:t}=await BX.ajax.runComponentAction("sotbit:rvw.questions","contentLoader",{mode:"class",signedParameters:this.signedParameters,data:{more:e}}),i=BX.processHTML(t.html,!1),n=(new DOMParser).parseFromString(i.HTML,"text/html").querySelector(".reviews__content_wrapper");n&&(this.blockParent.querySelector(".pagination-reviews-wrapper")?.remove(),this.blockParent.insertAdjacentHTML("beforeend",n.innerHTML),BX.ajax.processScripts(i.SCRIPT))}catch(e){console.error(e)}finally{BX.closeWait()}},elementRecalculationLike:function(e,t=!0){let i=e.querySelector("p"),n=i.innerHTML;if(itemNodeParent=i.closest(".content__reviews__item__control__item"),e.classList.contains("btn-reviews-small--active")){let s={};s[e.dataset.value.toUpperCase()]="N",s.QUESTION_ID=e.dataset.id,t?this.elementLikeController(s,e):(i.textContent="0"!=n?Number(n)-1==0?"0":Number(n)-1:"0",e.classList.remove("btn-reviews-small--active"))}else{let s={};s[e.dataset.value.toUpperCase()]="Y",s.QUESTION_ID=e.dataset.id,t?this.elementLikeController(s,e):(i.textContent="0"!=n?Number(n)+1:"1",e.classList.add("btn-reviews-small--active"))}},elementLikeController:async function(e,t){BX.ajax.runComponentAction("sotbit:rvw.questions.list","like",{mode:"class",data:{data:e}}).then((e=>{1!=e.data&&this.elementRecalculationLike(t,!1)}),(e=>{this.elementRecalculationLike(t,!1)}))},hideOverlay:function(e="top",t=document.body){const i=t.querySelector(".overlay");i&&(i.style.opacity=0,setTimeout((()=>{i.remove()}),1e3*parseFloat(getComputedStyle(document.body).getPropertyValue("--transition"))))}};
//# sourceMappingURL=script.min.js.map
